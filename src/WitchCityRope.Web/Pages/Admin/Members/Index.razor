@page "/admin/members"
@rendermode @(new Microsoft.AspNetCore.Components.Web.InteractiveServerRenderMode())
@using WitchCityRope.Core.DTOs
@using WitchCityRope.Web.Components.Admin.Members
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Roles = "Administrator,Moderator")]

<PageTitle>Member Management - WitchCityRope Admin</PageTitle>

<div class="admin-page">
    <div class="page-header">
        <h1>Member Management</h1>
        <p class="text-muted">Manage all community members and their information</p>
    </div>
    
    <MemberStats Stats="@Stats" IsLoading="@IsLoadingStats" />
    
    <div class="filters-section card shadow-sm mb-4">
        <div class="card-body">
            <MemberFilters @bind-VettingStatus="@VettingStatus"
                          @bind-SearchTerm="@SearchTerm"
                          @bind-PageSize="@PageSize"
                          OnFilterChanged="@ApplyFilters" />
        </div>
    </div>
    
    <div class="grid-section">
        @if (IsLoadingMembers)
        {
            <div class="text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading members...</span>
                </div>
                <p class="mt-2">Loading members...</p>
            </div>
        }
        else if (!Members.Any())
        {
            <div class="text-center py-5">
                <i class="bi bi-people fs-1 text-muted"></i>
                <p class="mt-2">No members found matching your criteria</p>
            </div>
        }
        else
        {
            <MemberDataGrid Members="@Members"
                           TotalCount="@TotalCount"
                           CurrentPage="@CurrentPage"
                           PageSize="@PageSize"
                           SortBy="@SortBy"
                           SortDirection="@SortDirection"
                           OnSort="@HandleSort"
                           OnPageChange="@HandlePageChange"
                           OnRowClick="@NavigateToMember" />
        }
    </div>
</div>